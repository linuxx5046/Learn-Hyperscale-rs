graph LR
    subgraph "Fase 1: RecepÃ§Ã£o"
        RX["ðŸ“¥ TransaÃ§Ã£o Recebida  
TX(Sender, Receiver, Amount)"]
        VALIDATE_TX["âœ… ValidaÃ§Ã£o  
- Assinatura Ed25519  
- Nonce  
- Saldo"]
    end
    
    subgraph "Fase 2: Mempool"
        MEMPOOL["ðŸ“¦ Mempool  
Fila de TransaÃ§Ãµes"]
        CONFLICT["âš ï¸ DetecÃ§Ã£o de Conflito  
Mesmo Sender?"]
        QUEUE["ðŸ“‹ Enfileira TX  
Ordem: Nonce"]
    end
    
    subgraph "Fase 3: ProposiÃ§Ã£o de Bloco"
        PROPOSE["ðŸ‘‘ LÃ­der Seleciona TXs  
Merkle Root = Hash(TX1..TXn)"]
        PENDING["ðŸ”¨ PendingBlock  
Assembling State"]
    end
    
    subgraph "Fase 4: Consenso"
        CONSENSUS["ðŸ—³ï¸ Consenso BFT  
VotaÃ§Ã£o e QC"]
        COMMIT["âœ… Bloco Commitado  
Two-Chain Rule"]
    end
    
    subgraph "Fase 5: ExecuÃ§Ã£o"
        EXEC["âš¡ ExecuÃ§Ã£o DeterminÃ­stica  
Para cada TX: Apply(State)"]
        STATE_UPDATE["ðŸ”„ Atualiza State Root  
Hash(Novo Estado)"]
        FINALIZE["âœ”ï¸ TX Finalizada  
ImutÃ¡vel e Confirmada"]
    end
    
    RX --> VALIDATE_TX
    VALIDATE_TX -->|VÃ¡lida| MEMPOOL
    VALIDATE_TX -->|InvÃ¡lida| DROP["âŒ Descarta TX"]
    
    MEMPOOL --> CONFLICT
    CONFLICT -->|Conflito| QUEUE
    CONFLICT -->|Sem Conflito| QUEUE
    
    QUEUE --> PROPOSE
    PROPOSE --> PENDING
    PENDING --> CONSENSUS
    CONSENSUS --> COMMIT
    COMMIT --> EXEC
    EXEC --> STATE_UPDATE
    STATE_UPDATE --> FINALIZE
    
    style RX fill:#ff6b6b,stroke:#c92a2a,color:#fff
    style MEMPOOL fill:#ffd43b,stroke:#f59f00,color:#000
    style CONSENSUS fill:#4c6ef5,stroke:#1971c2,color:#fff
    style EXEC fill:#51cf66,stroke:#2f9e44,color:#fff
    style FINALIZE fill:#da77f2,stroke:#9c36b5,color:#fff