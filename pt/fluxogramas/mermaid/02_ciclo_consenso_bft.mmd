graph TD
    START["ðŸš€ InÃ­cio da Ã‰poca  
Epoch = N"] --> ROUND["ðŸ“ Round = 0"]
    
    ROUND --> LEADER["ðŸ‘‘ EleiÃ§Ã£o de LÃ­der  
Leader = Validator[Round % N]"]
    
    LEADER --> PROPOSE["ðŸ“ LÃ­der PropÃµe Bloco  
Block(Epoch, Round, Txs)"]
    
    PROPOSE --> RECEIVE["ðŸ“¥ NÃ³s Recebem Proposta"]
    
    RECEIVE --> VALIDATE["âœ… ValidaÃ§Ã£o do Bloco  
- Assinatura do LÃ­der  
- Merkle Root  
- State Root"]
    
    VALIDATE -->|VÃ¡lido| VOTE["ðŸ—³ï¸ NÃ³ Vota no Bloco  
Vote(Block, Validator)"]
    VALIDATE -->|InvÃ¡lido| SKIP["â­ï¸ Pula para PrÃ³ximo Round"]
    
    VOTE --> COLLECT["ðŸ“Š Coleta de Votos  
VoteSet acumula votos"]
    
    COLLECT --> CHECK_QC{"2f+1 Votos  
Recebidos?"}
    
    CHECK_QC -->|NÃ£o| TIMEOUT["â±ï¸ Timeout  
Aguarda mais votos"]
    TIMEOUT --> SKIP
    
    CHECK_QC -->|Sim| AGGREGATE["ðŸ”— AgregaÃ§Ã£o de Assinaturas  
BLS12-381 Signature Aggregation"]
    
    AGGREGATE --> CREATE_QC["ðŸŽ–ï¸ Cria Quorum Certificate  
QC(Block, Signers, AggSig)"]
    
    CREATE_QC --> COMMIT{"Block Commitado?  
Two-Chain Rule"}
    
    COMMIT -->|NÃ£o| NEXT_ROUND["ðŸ”„ PrÃ³ximo Round  
Round += 1"]
    COMMIT -->|Sim| EXECUTE["âš¡ Executa TransaÃ§Ãµes  
Atualiza State Root"]
    
    EXECUTE --> EPOCH_CHECK{"Fim da Ã‰poca?  
Blocos >= Threshold"}
    
    EPOCH_CHECK -->|NÃ£o| NEXT_ROUND
    EPOCH_CHECK -->|Sim| NEW_EPOCH["ðŸŒŸ Nova Ã‰poca  
Epoch += 1  
Round = 0"]
    
    NEW_EPOCH --> ROUND
    NEXT_ROUND --> LEADER
    SKIP --> LEADER
    
    style START fill:#ff6b6b,stroke:#c92a2a,color:#fff
    style VOTE fill:#4c6ef5,stroke:#1971c2,color:#fff
    style CREATE_QC fill:#51cf66,stroke:#2f9e44,color:#fff
    style EXECUTE fill:#ffd43b,stroke:#f59f00,color:#000
    style NEW_EPOCH fill:#da77f2,stroke:#9c36b5,color:#fff